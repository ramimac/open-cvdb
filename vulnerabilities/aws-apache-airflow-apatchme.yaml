title: AWS Amazon Managed Workflows for Apache Airflow Stored XSS
slug: mwaa-apatchme
cves: CVE-2023-29247
affectedPlatforms:
- AWS
affectedServices:
- MWAA
image: https://images.unsplash.com/photo-1564979045531-fa386a275b27?q=80&w=1332&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D
severity: Medium
discoveredBy:
  name: Liv Matan
  org: Tenable (Ermetic)
  domain: https://www.tenable.com
  twitter: terminatorLM
disclosedAt: 2023/11/02
publishedAt: 2023/11/02
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
  AWS Amazon Managed Workflows for Apache Airflow was not patched against 
  CVE-2023-29247 (Stored XSS). Authenticated threat actors can use ApatchMe
  to store their JavaScript payload in the victim's managed Apache Airflow
  and run JavaScript on behalf of the victim (who can be an admin or other
  user with more permissions than the threat actor, leading to privilege escalation).
  With JavaScript, threat actors can run any operation in the session that the victim
  could â€” edit tasks, read jobs, job runs, read plugins and configurations, 
  list connections, add variables and more.
manualRemediation: |
  Users should take steps to update their Apache Airflow instances 
  and choose the updated version when creating a new one. MWAA users 
  can perform an environment update through the AWS Console by selecting
  the affected environment and then selecting Edit->Next->Next->Save to
  ensure that their current Airflow version has the latest security fixes.
detectionMethods: null
contributor: https://github.com/ramimac
references:
- https://www.tenable.com/blog/apatchme-authenticated-stored-xss-vulnerability-in-aws-and-gcp-apache-airflow-services
